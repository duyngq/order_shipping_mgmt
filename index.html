<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>SaigonAir Cargo</title>
    <link rel="stylesheet" href="css/main.css"/>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="js/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!--<link rel="stylesheet" href="css/dataTables.bootstrap.min.css">-->
    <!--<script src="js/jquery.dataTables.min.js"></script>-->
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js"></script>

    <!-- use dialog -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <link rel="stylesheet" href="css/dataTables.bootstrap.min.css">
    <!--<script src="js/dataTables.bootstrap.min.js"></script>-->
    <!--<script src="js/jquery.dataTables.min.js"></script>-->
    <script src="js/sga-main.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function () {
            //all findAll() function to show all orders
            findAll();
            /*editor = new $.fn.dataTable.Editor ({
                //https://editor.datatables.net/examples/styling/envelopeInTable.html
                //https://editor.datatables.net/examples/simple/inTableControls.html
                //https://editor.datatables.net/examples/styling/bootstrap.html
                //https://editor.datatables.net/examples/simple/template.html
                "ajax": '/orders/all',
                "table": "#example",
                "fields": [
                    {
                        "label": "ID",
                        "name": "id"
                    }, {
                        "label": "Date:",
                        "name": "date"
                    }, {
                        "label": "Sender Cust Name:",
                        "name": "s_name"
                    }, {
                        "label": "Phone",
                        "name": "s_phone"
                    }, {
                        "label": "Address",
                        "name": "s_addr"
                    }, {
                        "label": "Receiver Cust Name",
                        "name": "r_name"
                    }, {
                        "label": "Phone",
                        "name": "r_phone"
                    }, {
                        "label": "Address:",
                        "name": "r_addr"
                    }, {
                        "label": "Weight:",
                        "name": "weight"
                    }, {
                        "label": "Amount",
                        "name": "amount"
                    }
                ]
            });*/

            /*$ ('#orderTbl').on ('click', 'a.order-edit', function (e) {
                e.preventDefault ();

//                editor.edit($(this).closest('tr'), {
//                    title: 'Edit order',
//                    buttons: 'Update'
//                });
                editor
                    .title ('Edit record')
                    .buttons ({
                        "label": "Update", "fn": function () {
                            editor.submit ()
                        }
                    })
                    .edit ($ (this).closest ('tr'));
            });*/

            $('#orderTbl').DataTable({
                "columnDefs": [{
                    "targets": -1,
                    "data": null,
                    "orderable": false,
                    // make links in one line
                    "defaultContent": "<span style='display:inline-flex !important;'><a href='Javascript:void(0);' id='editOrder' class='glyphicon glyphicon-pencil'></a> <a href='Javascript:void(0);' id='delOrder' class='glyphicon glyphicon-trash'></a> </span>"
                }],
                "footerCallback": function (row, data, start, end, display) {
                    var api = this.api(), data;

                    // Remove the formatting to get integer data for summation
                    var intVal = function (i) {
                        return typeof i === 'string' ?
                            i.replace(/[\$,]/g, '') * 1 :
                            typeof i === 'number' ?
                                i : 0;
                    };

                    // Total over all pages
                    totalWeight = api.column(8).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Total over this page
                    totalWeightPerPage = api.column(8, {page: 'current'}).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Update footer
                    $(api.column(8).footer()).html(
                        +totalWeightPerPage + ' ( ' + totalWeight + ' total)'
                    );

                    // Total amount
                    totalAmount = api.column(9).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Total over this page
                    totalAmountPerPage = api.column(9, {page: 'current'}).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Update footer
                    $(api.column(9).footer()).html(
                        '$' + totalAmountPerPage + ' ( $' + totalAmount + ' total)'
                    );
                }
            });

            $('#shippingTbl').DataTable();
            $('#deliveredTbl').DataTable({
                "columnDefs": [{
                    "targets": -1,
                    "data": null,
                    "orderable": false,
                    // make links in one line
                    "defaultContent": "<span style='display:inline-flex !important;'><a href='#' class='delivered-edit glyphicon glyphicon-pencil'></a> <a href='#' class='delivered-delete glyphicon glyphicon-trash'></a> </span>"
                }],
                "footerCallback": function (row, data, start, end, display) {
                    var api = this.api(), data;

                    // Remove the formatting to get integer data for summation
                    var intVal = function (i) {
                        return typeof i === 'string' ?
                            i.replace(/[\$,]/g, '') * 1 :
                            typeof i === 'number' ?
                                i : 0;
                    };

                    // Total over all pages
                    totalWeight = api.column(8).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Total over this page
                    totalWeightPerPage = api.column(8, {page: 'current'}).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Update footer
                    $(api.column(8).footer()).html(
                        +totalWeightPerPage + ' ( ' + totalWeight + ' total)'
                    );

                    // Total amount
                    totalAmount = api.column(9).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Total over this page
                    totalAmountPerPage = api.column(9, {page: 'current'}).data().reduce(function (a, b) {
                        return intVal(a) + intVal(b);
                    }, 0);

                    // Update footer
                    $(api.column(9).footer()).html(
                        '$' + totalAmountPerPage + ' ( $' + totalAmount + ' total)'
                    );
                }
            });
            //TODO: https://editor.datatables.net/examples/advanced/deepObjects.html
            var senderTable = $('#senderTbl').DataTable({
                "columnDefs": [{
                    "targets": -1,
                    "data": null,
                    "orderable": false,
                    // make links in one line
                    "defaultContent": "<span style='display:inline-flex !important;'><a href='Javascript:void(0);' id='editOrder' class='glyphicon glyphicon-pencil'></a> <a href='Javascript:void(0);' id='delOrder' class='glyphicon glyphicon-trash'></a> </span>"
                }],
                "order": [[1, 'asc']],
                "processing": true,
                "serverSide": true,
                'ajax': {
                    "type": "GET",
                    "url": 'http://localhost:8808/api/customer/senders',
                    "dataSrc": ""
                },
                'columns': [
                    {"data": "id"},
                    {"data": "cust_name"},
                    {"data": "phone"},
                    {"data": "address"},
                ],
                'dataFilter': function (data) {
                    var list = data == null ? [] : (data.customers instanceof Array ? data.customers : [data.customers]);
                    var json = jQuery.parseJSON(list);
                    json.recordsTotal = json.total;
                    json.recordsFiltered = json.total;
                    json.data = json.list;

                    return JSON.stringify(json); // return JSON string
                }
            });

//            senderTable.on('order.dt search.dt', function () {
//                t.column(0, {search: 'applied', order: 'applied'}).nodes().each(function (cell, i) {
//                    cell.innerHTML = i + 1;
//                });
//            }).draw();

            // work with tab
            $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                $($.fn.dataTable.tables(true)).DataTable()
                    .columns.adjust();
            });

//            $("ul.nav-tabs a").click(function (e) {
//                e.preventDefault();
//                $(this).tab('show');
//            });


        });

        $(function () {
            $("#addOrder").click(function (e) {
                e.preventDefault();
                var dlg = $('<div></div>')
                    .html('<iframe style="border: 0px;" src="addorder.html" width="100%" height="100%"></iframe>').dialog({
                        title: "Add Order",
                        autoOpen: false,
                        modal: true,
                        position: ["left", "top"],
                        width: "100%",
                        height: $(window).height(),
                        zIndex: 1000
                    });
                dlg.dialog('open');
            });

            $("#orderTbl").on('click', '#delOrder', (function (event) {
                event.preventDefault();
                deleteOrder($('#orderTbl').DataTable().row($(this).parents('tr')));
                return false;
            }));

            $("#orderTbl").on('click', '#editOrder', (function (event) {
                    alert("abc");
                    event.preventDefault();
                    return false;
                })
            );
        });
    </script>

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">-->
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->
    <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
    <!-- full bootstrap 3.3.7 with glyphicons
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    -->
</head>

<body>

<div class="container">

    <nav class="navbar bg-primary">
        <!--navbar-fixed-top"> add this class to fixed top toolbar -> span all horizontal-->
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <p class="navbar-brand">SaigonAir Cargo</p>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <!-- refer this link to create a right menu
            https://www.w3schools.com/bootstrap/tryit.asp?filename=trybs_ref_js_dropdown_multilevel_css&stacked=h
            or
            https://bootsnipp.com/snippets/65zm
            -->
            <div class="collapse navbar-collapse sga-nav-color navbar-right">
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <!--<ul class="dropdown-menu">-->
                        <!--<li><a href="" id="addOrder">Order</a></li>-->
                        <!--<li><a href="">Shipping</a></li>-->
                        <!--&lt;!&ndash;<li class="dropdown-submenu">&ndash;&gt;-->
                        <!--&lt;!&ndash;<a href="" class="dropdown-toggle" data-toggle="dropdown">Customer</a>&ndash;&gt;-->
                        <!--&lt;!&ndash;<ul class="dropdown-menu">&ndash;&gt;-->
                        <!--<li><a href="">Sender</a></li>-->
                        <!--<li><a href="">Receiver</a></li>-->
                        <!--&lt;!&ndash;</ul>&ndash;&gt;-->
                        <!--&lt;!&ndash;</li>&ndash;&gt;-->
                        <!--</ul>-->
                        <a href="" class="btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                           aria-expanded="false">Add<span class="caret"></span></a>
                        <!--<button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Add-->
                        <!--<span class="caret"></span></button>-->
                        <ul class="dropdown-menu">
                            <li><a href="Javascript:void(0);" id="addOrder">Order</a></li>
                            <li><a href="#">Shipping</a></li>
                            <div class="dropdown-divider"></div>
                            <li><a href="#">Sender</a></li>
                            <li><a href="#">Receiver</a></li>
                        </ul>
                    </li>
                    <li><a href=""><span>Search</span></a></li>
                    <li><a href=""><span>Logout</span></a></li>
                </ul>
                <!--<ul class="nav navbar-nav navbar-right sga-nav-color">-->
                <!--&lt;!&ndash; TODO: good menu but maybe noneed&ndash;&gt;-->
                <!--<li class="dropdown">-->
                <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"-->
                <!--aria-expanded="false">Order </a>-->
                <!--<ul class="dropdown-menu">-->
                <!--<li><a href="#">Add</a></li>-->
                <!--<li><a href="#">View</a>-->
                <!--<ul class="">-->
                <!--<li><a href=""> Processing</a></li>-->
                <!--<li><a href=""> Shipping</a></li>-->
                <!--<li><a href=""> Delivered</a></li>-->
                <!--</ul>-->
                <!--</li>-->
                <!--</ul>-->
                <!--</li>-->
                <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                   aria-haspopup="true"
                   aria-expanded="false">View<span class="caret"></span></a>
                <ul class="dropdown-menu">
                    <div class="navbar-collapse collapse sidebar-navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li class="active"><a href="#">Menu Item 1</a></li>
                            <li><a href="#">Menu Item 2</a></li>
                            <li><a href="#">Menu Item 3</a></li>
                            <li><a href="#">Menu Item 4</a></li>
                            <li><a href="#">Reviews <span class="badge">1,118</span></a></li>
                        </ul>
                    </div>&lt;!&ndash;/.nav-collapse &ndash;&gt;
                </ul>--
            </ul>
        </li-->
                <!--
                <ul class="mainmenu">
                    <li><a href="#">Add</a></li>
                    <ul class="submenu">
                        <li><a href=""> Order</a></li>
                        <li><a href=""> Customer</a></li>
                        <ul class="submenu">
                            <li><a href=""> Sender</a></li>
                            <li><a href=""> Receiver</a></li>
                        </ul>
                    </ul>
                    </li>
                </ul>
                <li><a href="#">Search</a></li>
                -->
                <!--<li><a href="#">Add</a></li>-->
                <!--<li><a href="#">Search</a></li>-->
                <!--<li><a href="#"><span class="glyphicon glyphicon-log-out">Logout</span></a></li>-->
                <!--get image for login/logout-->
                <!--<li><a href="#">Logout</span></a></li>-->
                <!--</ul>-->
            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>

    <!-- main tab -->
    <ul class="nav nav-tabs" id="mainTab">
        <li class="active"><a href="#ordersTab" data-toggle="tab">Orders</a></li>
        <li><a href="#customersTab" data-toggle="tab">Customers</a></li>
    </ul>
    <!-- main tab content -->
    <div class="tab-content">
        <!-- https://stackoverflow.com/questions/26857805/bootstrap-nested-tabs -->
        <!-- orders tab-->
        <div class="tab-pane fade active in" id="ordersTab">
            <!-- orders tab content -->
            <!-- data table to show all orders -->
            <div class="tabbable">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#orderedTab" data-toggle="tab">Ordered</a></li>
                    <li><a href="#shippingTab" data-toggle="tab">Shipping</a></li>
                    <li><a href="#deliveredTab" data-toggle="tab">Delivered</a></li>
                </ul>
                <div class="tab-content">
                    <div class="table-responsive tab-pane active" id="orderedTab">
                        <table id="orderTbl" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead class="bg-primary">
                            <tr>
                                <th>No.</th>
                                <th>Date</th>
                                <th>Sender</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Receiver</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Weight</th>
                                <th>Amount</th>
                                <th></th>
                            </tr>
                            </thead>

                            <tfoot>
                            <tr>
                                <th colspan="8">Total</th>
                                <th id="orderedWeight">0</th>
                                <th id="orderedAmount">0</th>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                    <!-- data table to show all shipping orders -->
                    <div class="table-responsive tab-pane" id="shippingTab">
                        <table id="shippingTbl" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead class="bg-primary">
                            <tr>
                                <th>No.</th>
                                <th>Date</th>
                                <th>Sender</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Receiver</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Weight</th>
                                <th>Amount</th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                    <!-- data table to show all delivered orders -->
                    <div class="table-responsive tab-pane" id="deliveredTab">
                        <table id="deliveredTbl" class="table table-striped table-bordered" cellspacing="0"
                               width="100%">
                            <thead class="bg-primary">
                            <tr>
                                <th>No.</th>
                                <th>Date</th>
                                <th>Sender</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Receiver</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Weight</th>
                                <th>Amount</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tfoot>
                            <tr>
                                <th colspan="8">Total</th>
                                <th id="deliveredWeight">0</th>
                                <th id="deliveredAmount">0</th>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!-- customers tab content -->
        <!-- tab to show all customers -->
        <div class="tab-pane fade in" id="customersTab">
            <div class="tabbable">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#senderTab" data-toggle="tab">Senders</a></li>
                    <li><a href="#recvTab" data-toggle="tab">Receivers</a></li>
                </ul>
                <div class="tab-content">
                    <div class="table-responsive tab-pane active" id="senderTab">
                        <table id="senderTbl" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead class="bg-primary">
                            <tr>
                                <th>No.</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th></th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                    <!-- data table to show all receivers -->
                    <div class="table-responsive tab-pane" id="recvTab">
                        <table id="recvTbl" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <thead class="bg-primary">
                            <tr>
                                <th>No.</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th></th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- end tab-content-->
</div> <!-- end container -->
</body>
</html>


<!--
<div class="header">
<input type="text" id="searchKey"/>
<button id="btnSearch">Search</button>
<button id="btnAdd">New Wine</button>
</div>


<div class="leftArea">
<ul id="wineList"></ul>
</div>

<form id="wineForm">

<div class="mainArea">

<label>Id:</label>
<input id="wineId" name="id" type="text" disabled />

<label>Name:</label>
<input type="text" id="name" name="name" required>

<label>Grapes:</label>
<input type="text" id="grapes" name="grapes"/>

<label>Country:</label>
<input type="text" id="country" name="country"/>

<label>Region:</label>
<input type="text" id="region" name="region"/>

<label>Year:</label>
<input type="text" id="year" name="year"/>

<button id="btnSave">Save</button>
<button id="btnDelete">Delete</button>

</div>

<div class="rightArea">

<img id="pic" height="300"/>

<label>Notes:</label>
<textarea id="description" name="description"></textarea>
</div>

</form>

<script src="js/jquery-1.7.1.min.js"></script>
<script src="js/main.js"></script>
-->